<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form with Dynamic Employees</title>
    <link href="https://cdn.jsdelivr.net/npm/flowbite@2.5.2/dist/flowbite.min.css" rel="stylesheet" />

</head>

<body class="bg-white dark:bg-gray-900 bg-[url('https://flowbite.s3.amazonaws.com/docs/jumbotron/hero-pattern.svg')] dark:bg-[url('https://flowbite.s3.amazonaws.com/docs/jumbotron/hero-pattern-dark.svg')]">
    <script src="https://cdn.jsdelivr.net/npm/flowbite@2.5.2/dist/flowbite.min.js"></script>      
    <section class="max-w-full mx-auto p-4 bg-white m-6">
        <div class="py-6 px-4 mx-auto max-w-screen-xl text-center lg:py-16 z-10 relative">
            <h1 class="mb-4 text-3xl font-extrabold text-gray-900 dark:text-white md:text-5xl lg:text-6xl"><span class="text-transparent bg-clip-text bg-gradient-to-b to-emerald-600 from-sky-400">Create Company in HSE</span></h1>

        </div>
    </section>

    <form class="w-full max-w-xl mx-auto p-4 bg-white mx-6" method="POST">
        
        <h5 class="text-xl dark:text-white text-center p-3">Onboarding Ticket</h5>
        <div class="flex max-w-sm mx-auto">
            <button id="env-dropdown-button" data-dropdown-toggle="dropdown" style="width: 120px;" class="flex-shrink-0 z-10 inline-flex items-center py-2.5 px-4 text-sm font-medium text-center text-gray-900 bg-gray-100 border border-gray-300 rounded-s-lg hover:bg-gray-200 focus:ring-4 focus:outline-none focus:ring-gray-100 dark:bg-gray-700 dark:hover:bg-gray-600 dark:focus:ring-gray-700 dark:text-white dark:border-gray-600" type="button">
                Production 
            <svg class="w-2.5 h-2.5 ms-2.5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 6"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 4 4 4-4"/></svg></button>
            
            <div id="dropdown" class="z-10 hidden bg-white divide-y divide-gray-100 rounded-lg shadow w-44 dark:bg-gray-700">
                <ul class="py-2 text-sm text-gray-700 dark:text-gray-200" aria-labelledby="env-dropdown-button">
                    <li>
                        <button onclick="chooseEnv('Production')" type="button" class="inline-flex w-full px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white">Production</button>
                    </li>
                    <li>
                        <button onclick="chooseEnv('Preview')" type="button" class="inline-flex w-full px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white">Preview</button>
                    </li>
                </ul>
            </div>
            <div class="relative w-full">
                <input type="search" id="ticketNumberInput" class="block p-2.5 w-full z-20 text-sm text-gray-900 bg-gray-50 rounded-e-lg border-s-gray-50 border-s-2 border border-gray-300 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-s-gray-700  dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:border-blue-500" placeholder="e.g 123456" required />
                <button id="fetchTicketButton" onclick="fetchTicket()" type="button" class="absolute top-0 end-0 p-2.5 text-sm font-medium h-full text-white bg-blue-700 rounded-e-lg border border-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800">
                    Fetch Ticket
                </button>
            </div>
        </div>
        <p class="m-4 text-xs text-gray-500 dark:text-gray-400  pb-6"><i>The onboarding ticket number is used for logging progress on the card (Internal Notes)</i> </p>




        <!-- Company Info -->
        <h5 class="text-xl dark:text-white text-center p-3">Company Information</h5>
        <div class="border p-3 mb-6" >

            <div class="relative my-3">
                <input value="" type="text" id="companyName" class="block px-2.5 pb-2.5 pt-4 w-full text-sm text-gray-900 bg-transparent rounded-lg border-1 border-gray-300 appearance-none dark:text-white dark:border-gray-600 dark:focus:border-blue-500 focus:outline-none focus:ring-0 focus:border-blue-600 peer" placeholder=" " />
                <label for="companyName" class="absolute text-sm text-gray-500 dark:text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-white dark:bg-gray-900 px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:dark:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 rtl:peer-focus:translate-x-1/4 rtl:peer-focus:left-auto start-1">Company Name:</label>
            </div>

            <div class="relative my-3">
                <input value="" type="text" id="companyAddress" class="block px-2.5 pb-2.5 pt-4 w-full text-sm text-gray-900 bg-transparent rounded-lg border-1 border-gray-300 appearance-none dark:text-white dark:border-gray-600 dark:focus:border-blue-500 focus:outline-none focus:ring-0 focus:border-blue-600 peer" placeholder=" " />
                <label for="companyAddress" class="absolute text-sm text-gray-500 dark:text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-white dark:bg-gray-900 px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:dark:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 rtl:peer-focus:translate-x-1/4 rtl:peer-focus:left-auto start-1">Company Address:</label>
            </div>

            <div class="flex items-center mb-4">
                <input id="isMTA" name="isMTA" type="checkbox" value="" class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                <label for="isMTA" class="ms-2 text-sm font-medium text-gray-900 dark:text-gray-300">Is MTA?</label>
            </div>

         </div>

        <!-- Main Contact Info -->
        <h5 class="text-xl dark:text-white text-center p-3">Main Contact Information</h5>
        <div class="border p-3 grid gap-6 mb-6 md:grid-cols-2" >


            <div class="relative my-1">
                <input type="text" id="mainContactFirstName" name="mainContactFirstName" class="block px-2.5 pb-2.5 pt-4 w-full text-sm text-gray-900 bg-transparent rounded-lg border-1 border-gray-300 appearance-none dark:text-white dark:border-gray-600 dark:focus:border-blue-500 focus:outline-none focus:ring-0 focus:border-blue-600 peer" placeholder=" " value="" required>
                <label for="mainContactFirstName" class="absolute text-sm text-gray-500 dark:text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-white dark:bg-gray-900 px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:dark:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 rtl:peer-focus:translate-x-1/4 rtl:peer-focus:left-auto start-1">First Name:</label>
            </div>

            <div class="relative my-1">
                <input type="text" id="mainContactLastName" name="mainContactLastName" class="block px-2.5 pb-2.5 pt-4 w-full text-sm text-gray-900 bg-transparent rounded-lg border-1 border-gray-300 appearance-none dark:text-white dark:border-gray-600 dark:focus:border-blue-500 focus:outline-none focus:ring-0 focus:border-blue-600 peer" placeholder=" " value="" required>
                <label for="mainContactLastName" class="absolute text-sm text-gray-500 dark:text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-white dark:bg-gray-900 px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:dark:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 rtl:peer-focus:translate-x-1/4 rtl:peer-focus:left-auto start-1">Last Name:</label>
            </div>

            <div class="relative my-1">
                <input type="email" id="mainContactEmail" name="mainContactEmail" class="block px-2.5 pb-2.5 pt-4 w-full text-sm text-gray-900 bg-transparent rounded-lg border-1 border-gray-300 appearance-none dark:text-white dark:border-gray-600 dark:focus:border-blue-500 focus:outline-none focus:ring-0 focus:border-blue-600 peer" placeholder=" "  value="" required>
                <label for="mainContactEmail" class="absolute text-sm text-gray-500 dark:text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-white dark:bg-gray-900 px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:dark:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 rtl:peer-focus:translate-x-1/4 rtl:peer-focus:left-auto start-1">Email:</label>

            </div>

            <div class="relative my-1">
                <input type="text" id="mainContactPhoneNumber" name="mainContactPhoneNumber" class="block px-2.5 pb-2.5 pt-4 w-full text-sm text-gray-900 bg-transparent rounded-lg border-1 border-gray-300 appearance-none dark:text-white dark:border-gray-600 dark:focus:border-blue-500 focus:outline-none focus:ring-0 focus:border-blue-600 peer" placeholder=" "  value="" required>
                <label for="mainContactPhoneNumber" class="absolute text-sm text-gray-500 dark:text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-white dark:bg-gray-900 px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:dark:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 rtl:peer-focus:translate-x-1/4 rtl:peer-focus:left-auto start-1">Phone Number:</label>
            </div>

            <div class="relative my-1">
                <input type="text" id="mainContactMobileNumber" name="mainContactMobileNumber" class="block px-2.5 pb-2.5 pt-4 w-full text-sm text-gray-900 bg-transparent rounded-lg border-1 border-gray-300 appearance-none dark:text-white dark:border-gray-600 dark:focus:border-blue-500 focus:outline-none focus:ring-0 focus:border-blue-600 peer" placeholder=" "  value="" required>
                <label for="mainContactMobileNumber" class="absolute text-sm text-gray-500 dark:text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-white dark:bg-gray-900 px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:dark:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 rtl:peer-focus:translate-x-1/4 rtl:peer-focus:left-auto start-1">Mobile Number:</label>
            </div>


            <div class="relative my-1">

            </div>

            <div class="relative my-1">
                <input type="text" id="mainContactUsername" name="mainContactUsername" class="block px-2.5 pb-2.5 pt-4 w-full text-sm text-gray-900 bg-transparent rounded-lg border-1 border-gray-300 appearance-none dark:text-white dark:border-gray-600 dark:focus:border-blue-500 focus:outline-none focus:ring-0 focus:border-blue-600 peer" placeholder=" "  value="" required>
                <label for="mainContactUsername" class="absolute text-sm text-gray-500 dark:text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-white dark:bg-gray-900 px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:dark:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 rtl:peer-focus:translate-x-1/4 rtl:peer-focus:left-auto start-1">Login Name:</label>
            </div>

            <div class="relative my-1">
                <input type="password" id="mainContactPassword" name="mainContactPassword" class="block px-2.5 pb-2.5 pt-4 w-full text-sm text-gray-900 bg-transparent rounded-lg border-1 border-gray-300 appearance-none dark:text-white dark:border-gray-600 dark:focus:border-blue-500 focus:outline-none focus:ring-0 focus:border-blue-600 peer" placeholder=" "  value="" required>
                <label for="mainContactPassword" class="absolute text-sm text-gray-500 dark:text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-white dark:bg-gray-900 px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:dark:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 rtl:peer-focus:translate-x-1/4 rtl:peer-focus:left-auto start-1">Password:</label>
            </div>

        </div>

        <!-- Number of Employees -->
        <h5 class="text-xl dark:text-white text-center p-3">Employee Information</h5>
        <div style="margin: auto; width: 200px;" class="mb-5 items-center mx-auto flex" >
            <p class="mt-2 text-sm text-gray-500 dark:text-gray-400 text-center"><i>Number of Employees:</i> </p>
            <input   type="number" id="numberOfEmployees" name="numberOfEmployees" min="1" value="1" max="25" class="my-5 max-w-sm  border border-gray-300 rounded-md items-center m-auto" value="" required>
            
        </div>
        <p class="text-sm text-gray-500 dark:text-gray-400 text-center my-5"><i>(Remember to include the main contact so they have a personal login)</i> </p>

        <!-- Employee Fields -->
        <div id="employees-container" class="border p-3 grid gap-6 mb-6 md:grid-cols-2" ></div>

        <!-- Preview / Production selector & submit button-->
        <h5 class="text-xl dark:text-white text-center p-3">Automation Environment</h5>
        <div class="flex flex-wrap md:flex-nowrap items-center py-6 my-4 space-x-1">

            <div class="p-3 flex items-center ps-4 border border-gray-200 rounded dark:border-gray-700">
                <input checked id="environmentRadio1" type="radio" value="Preview" name="Environment-radio" class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                <label for="borderedRadio1" class="w-full ms-2 text-sm font-medium text-gray-900 dark:text-gray-300">Create in Preview</label>
            </div>
            <div class="p-3 flex items-center ps-4 border border-gray-200 rounded dark:border-gray-700">
                <input  id="environmentRadio2" type="radio" value="Production" name="Environment-radio" class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                <label  for="borderedRadio2" class="w-full ms-2 text-sm font-medium text-gray-900 dark:text-gray-300">Create in Production</label>
            </div>

            <!-- Submit -->
            <button id="startAutomationButton" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-4 px-4 rounded mx-auto" type="submit">Start Automation</button>

        </div>

    </form>

    <section class="max-w-full mx-auto p-4 bg-white m-6">
        <div class="py-6 px-4 mx-auto max-w-screen-xl text-center lg:py-16 z-10 relative">

            <div class="pt-6 max-w-screen-md mx-auto">

                <p class="mb-2 text-xl font-normal text-gray-700 dark:text-gray-200">"Start Automation" button will trigger the server to:</p>
                <hr class="mb-4" ></hr>
                <p class="mb-2 text-md text-left font-normal text-gray-500 dark:text-gray-200">1. Create a Cypress.config.js file based on the form results</p>
                <p class="mb-2 text-md text-left font-normal text-gray-500 dark:text-gray-200">2. Create a duplicate Cypress.config.js file in the Previous runs folder (For future reference)</p>
                <p class="mb-2 text-md text-left font-normal text-gray-500 dark:text-gray-200">3. Start the Cypress Automation</p>
                <p class="mb-2 text-md text-left font-normal text-gray-500 dark:text-gray-200">4. A new company will be created in Preview / Production</p>
                <p class="mb-2 text-md text-left font-normal text-gray-500 dark:text-gray-200">5. Progress will be logged on the onboarding ticket as an internal note</p>
                <p class="mb-8 text-md text-left font-normal text-gray-500 dark:text-gray-200">6. Follow up tasks will be added as a tasklist on the onboarding ticket</p>

            </div>
        </div>
    </section>

    <h1 id="1"></h1>

    <script>
        document.addEventListener('DOMContentLoaded', function() {

            const employeesContainer = document.getElementById('employees-container');
            const numberOfEmployeesInput = document.getElementById('numberOfEmployees');

            function updateEmployeeFields() {
                // Clear existing employee fields
                employeesContainer.innerHTML = '';
                
                const numberOfEmployees = parseInt(numberOfEmployeesInput.value);
                for (let i = 1; i <= numberOfEmployees; i++) {
                    const employeeDiv = document.createElement('div');
                    employeeDiv.classList.add('m-3');
                    employeeDiv.innerHTML = `
                        <p class="m-4 text-center text-xs text-gray-500 dark:text-gray-400  pb-4"><i>Employee ${i}</i> </p>

                        <div class="relative my-1" style="margin:10px">
                            <input placeholder=" " type="text" id="employee${i}Name" name="employee${i}Name" class="block px-2.5 pb-2.5 pt-4 w-full text-sm text-gray-900 bg-transparent rounded-lg border-1 border-gray-300 appearance-none dark:text-white dark:border-gray-600 dark:focus:border-blue-500 focus:outline-none focus:ring-0 focus:border-blue-600 peer" value="" required>
                            <label for="employee${i}Name" class="absolute text-sm text-gray-500 dark:text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-white dark:bg-gray-900 px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:dark:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 rtl:peer-focus:translate-x-1/4 rtl:peer-focus:left-auto start-1">Display Name:</label>
                        </div>

                        <div class="relative my-1" style="margin:10px">
                            <input placeholder=" " type="text" id="employee${i}LoginName" name="employee${i}LoginName" class="block px-2.5 pb-2.5 pt-4 w-full text-sm text-gray-900 bg-transparent rounded-lg border-1 border-gray-300 appearance-none dark:text-white dark:border-gray-600 dark:focus:border-blue-500 focus:outline-none focus:ring-0 focus:border-blue-600 peer" value="" required>
                            <label for="employee${i}LoginName" class="absolute text-sm text-gray-500 dark:text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-white dark:bg-gray-900 px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:dark:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 rtl:peer-focus:translate-x-1/4 rtl:peer-focus:left-auto start-1">Login Name:</label>
                        </div>

                        <div class="relative my-1" style="margin:10px">
                            <input placeholder=" " type="email" id="employee${i}Email" name="employee${i}Email" class="block px-2.5 pb-2.5 pt-4 w-full text-sm text-gray-900 bg-transparent rounded-lg border-1 border-gray-300 appearance-none dark:text-white dark:border-gray-600 dark:focus:border-blue-500 focus:outline-none focus:ring-0 focus:border-blue-600 peer" value="">
                            <label for="employee${i}Email" class="absolute text-sm text-gray-500 dark:text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-white dark:bg-gray-900 px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:dark:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 rtl:peer-focus:translate-x-1/4 rtl:peer-focus:left-auto start-1">Email:</label>
                        </div>
                        <div class="relative my-1" style="margin:10px">
                            <input placeholder=" " type="text" id="employee${i}Department" name="employee${i}Department" class="block px-2.5 pb-2.5 pt-4 w-full text-sm text-gray-900 bg-transparent rounded-lg border-1 border-gray-300 appearance-none dark:text-white dark:border-gray-600 dark:focus:border-blue-500 focus:outline-none focus:ring-0 focus:border-blue-600 peer" value="" required>
                            <label for="employee${i}Department" class="absolute text-sm text-gray-500 dark:text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-white dark:bg-gray-900 px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:dark:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 rtl:peer-focus:translate-x-1/4 rtl:peer-focus:left-auto start-1">Department:</label>
                        </div>
                        <div class="flex items-center m-4">
                            <input id="employee${i}IsManager" name="employee${i}IsManager" type="checkbox" value="" class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                            <label for="employee${i}IsManager" class="ms-2 text-sm font-medium text-gray-900 dark:text-gray-300">Is Manager?</label>
                        </div>
                        <hr>

                    `;
                    employeesContainer.appendChild(employeeDiv);
                }
            }

            // Initialize employee fields based on the initial number
            updateEmployeeFields();

            // Update employee fields when the number of employees changes
            numberOfEmployeesInput.addEventListener('input', updateEmployeeFields);
        });

        document.querySelector("form").addEventListener("submit", (e) => {
            e.preventDefault(); // Prevent the browser's default download behavior

            // Change Submit button appearance 
            document.getElementById('startAutomationButton').innerHTML = "Running Automation"
            document.getElementById('startAutomationButton').style.backgroundColor = "red"
            document.getElementById('startAutomationButton').style.fontSize = "13px"
            // document.getElementById('startAutomationButton').disabled = true


            const myHeaders = new Headers();
            myHeaders.append("Content-Type", "application/json");
            // Collect form data here
            const formData = new FormData(e.target);

            // Send form data to the server
            fetch("http://localhost:3000/download", {
                method: "POST",
                headers: myHeaders,
                body: JSON.stringify({
                    "TicketID": e.target.ticketNumberInput.value,
                    "Environment" : e.target.environmentRadio1.checked?"Preview":"Production",

                    "companyName": e.target.companyName.value,
                    "companyAddress": e.target.companyAddress.value, 
                    "mainContactFirstName": e.target.mainContactFirstName.value,
                    "mainContactLastName": e.target.mainContactLastName.value,
                    "mainContactEmail": e.target.mainContactEmail.value,
                    "mainContactPhoneNumber": e.target.mainContactPhoneNumber.value,
                    "mainContactMobileNumber": e.target.mainContactMobileNumber.value,
                    "mainContactUsername": e.target.mainContactUsername.value,
                    "mainContactPassword": e.target.mainContactPassword.value,
                    "isMTA": e.target.isMTA.checked,
                    "numberOfEmployees": e.target.numberOfEmployees.value,

                    "employee1Name": e.target.numberOfEmployees.value > 0 ?  e.target.employee1Name.value : null,
                    "employee1LoginName": e.target.numberOfEmployees.value > 0 ?  e.target.employee1LoginName.value : null,
                    "employee1Email": e.target.numberOfEmployees.value > 0 ?  e.target.employee1Email.value : null,
                    "employee1Department": e.target.numberOfEmployees.value > 0 ?  e.target.employee1Department.value : null,
                    "employee1IsManager": e.target.numberOfEmployees.value > 0 ?  e.target.employee1IsManager.checked : null,

                    "employee2Name": e.target.numberOfEmployees.value > 1 ?  e.target.employee2Name.value : null,
                    "employee2LoginName": e.target.numberOfEmployees.value > 1 ?  e.target.employee2LoginName.value : null,
                    "employee2Email": e.target.numberOfEmployees.value > 1 ?  e.target.employee2Email.value : null,
                    "employee2Department": e.target.numberOfEmployees.value > 1 ?  e.target.employee2Department.value : null,
                    "employee2IsManager": e.target.numberOfEmployees.value > 1 ?  e.target.employee2IsManager.checked : null,

                    "employee3Name": e.target.numberOfEmployees.value > 2 ? e.target.employee3Name.value : null,
                    "employee3LoginName": e.target.numberOfEmployees.value > 2 ? e.target.employee3LoginName.value : null,
                    "employee3Email": e.target.numberOfEmployees.value > 2 ? e.target.employee3Email.value : null,
                    "employee3Department": e.target.numberOfEmployees.value > 2 ? e.target.employee3Department.value : null,
                    "employee3IsManager": e.target.numberOfEmployees.value > 2 ? e.target.employee3IsManager.checked : null,

                    "employee4Name": e.target.numberOfEmployees.value > 3 ?  e.target.employee4Name.value : null,
                    "employee4LoginName": e.target.numberOfEmployees.value > 3 ?  e.target.employee4LoginName.value : null,
                    "employee4Email": e.target.numberOfEmployees.value > 3 ?  e.target.employee4Email.value : null,
                    "employee4Department": e.target.numberOfEmployees.value > 3 ?  e.target.employee4Department.value : null,
                    "employee4IsManager": e.target.numberOfEmployees.value > 3 ?  e.target.employee4IsManager.checked : null,

                    "employee5Name": e.target.numberOfEmployees.value > 4 ?  e.target.employee5Name.value : null,
                    "employee5LoginName": e.target.numberOfEmployees.value > 4 ?  e.target.employee5LoginName.value : null,
                    "employee5Email": e.target.numberOfEmployees.value > 4 ?  e.target.employee5Email.value : null,
                    "employee5Department": e.target.numberOfEmployees.value > 4 ?  e.target.employee5Department.value : null,
                    "employee5IsManager": e.target.numberOfEmployees.value > 4 ?  e.target.employee5IsManager.checked : null,

                    "employee6Name": e.target.numberOfEmployees.value > 5 ? e.target.employee6Name.value : null,
                    "employee6LoginName": e.target.numberOfEmployees.value > 5 ? e.target.employee6LoginName.value : null,
                    "employee6Email": e.target.numberOfEmployees.value > 5 ? e.target.employee6Email.value : null,
                    "employee6Department": e.target.numberOfEmployees.value > 5 ? e.target.employee6Department.value : null,
                    "employee6IsManager": e.target.numberOfEmployees.value > 5 ? e.target.employee6IsManager.checked : null,

                    "employee7Name": e.target.numberOfEmployees.value > 6 ?  e.target.employee7Name.value : null,
                    "employee7LoginName": e.target.numberOfEmployees.value > 6 ?  e.target.employee7LoginName.value : null,
                    "employee7Email": e.target.numberOfEmployees.value > 6 ?  e.target.employee7Email.value : null,
                    "employee7Department": e.target.numberOfEmployees.value > 6 ?  e.target.employee7Department.value : null,
                    "employee7IsManager": e.target.numberOfEmployees.value > 6 ?  e.target.employee7IsManager.checked : null,

                    "employee8Name": e.target.numberOfEmployees.value > 7 ?  e.target.employee8Name.value : null,
                    "employee8LoginName": e.target.numberOfEmployees.value > 7 ?  e.target.employee8LoginName.value : null,
                    "employee8Email": e.target.numberOfEmployees.value > 7 ?  e.target.employee8Email.value : null,
                    "employee8Department": e.target.numberOfEmployees.value > 7 ?  e.target.employee8Department.value : null,
                    "employee8IsManager": e.target.numberOfEmployees.value > 7 ?  e.target.employee8IsManager.checked : null,

                    "employee9Name": e.target.numberOfEmployees.value > 8 ? e.target.employee9Name.value : null,
                    "employee9LoginName": e.target.numberOfEmployees.value > 8 ? e.target.employee9LoginName.value : null,
                    "employee9Email": e.target.numberOfEmployees.value > 8 ? e.target.employee9Email.value : null,
                    "employee9Department": e.target.numberOfEmployees.value > 8 ? e.target.employee9Department.value : null,
                    "employee9IsManager": e.target.numberOfEmployees.value > 8 ? e.target.employee9IsManager.checked : null,

                    "employee10Name": e.target.numberOfEmployees.value > 9 ?  e.target.employee10Name.value : null,
                    "employee10LoginName": e.target.numberOfEmployees.value > 9 ?  e.target.employee10LoginName.value : null,
                    "employee10Email": e.target.numberOfEmployees.value > 9 ?  e.target.employee10Email.value : null,
                    "employee10Department": e.target.numberOfEmployees.value > 9 ?  e.target.employee10Department.value : null,
                    "employee10IsManager": e.target.numberOfEmployees.value > 9 ?  e.target.employee10IsManager.checked : null,

                    "employee11Name": e.target.numberOfEmployees.value > 10 ?  e.target.employee11Name.value : null,
                    "employee11LoginName": e.target.numberOfEmployees.value > 10 ?  e.target.employee11LoginName.value : null,
                    "employee11Email": e.target.numberOfEmployees.value > 10 ?  e.target.employee11Email.value : null,
                    "employee11Department": e.target.numberOfEmployees.value > 10 ?  e.target.employee11Department.value : null,
                    "employee11IsManager": e.target.numberOfEmployees.value > 10 ?  e.target.employee11IsManager.checked : null,

                    "employee12Name": e.target.numberOfEmployees.value > 11 ? e.target.employee12Name.value : null,
                    "employee12LoginName": e.target.numberOfEmployees.value > 11 ? e.target.employee12LoginName.value : null,
                    "employee12Email": e.target.numberOfEmployees.value > 11 ? e.target.employee12Email.value : null,
                    "employee12Department": e.target.numberOfEmployees.value > 11 ? e.target.employee12Department.value : null,
                    "employee12IsManager": e.target.numberOfEmployees.value > 11 ? e.target.employee12IsManager.checked : null,

                    "employee13Name": e.target.numberOfEmployees.value > 12 ?  e.target.employee13Name.value : null,
                    "employee13LoginName": e.target.numberOfEmployees.value > 12 ?  e.target.employee13LoginName.value : null,
                    "employee13Email": e.target.numberOfEmployees.value > 12 ?  e.target.employee13Email.value : null,
                    "employee13Department": e.target.numberOfEmployees.value > 12 ?  e.target.employee13Department.value : null,
                    "employee13IsManager": e.target.numberOfEmployees.value > 12 ?  e.target.employee13IsManager.checked : null,

                    "employee14Name": e.target.numberOfEmployees.value > 13 ?  e.target.employee14Name.value : null,
                    "employee14LoginName": e.target.numberOfEmployees.value > 13 ?  e.target.employee14LoginName.value : null,
                    "employee14Email": e.target.numberOfEmployees.value > 13 ?  e.target.employee14Email.value : null,
                    "employee14Department": e.target.numberOfEmployees.value > 13 ?  e.target.employee14Department.value : null,
                    "employee14IsManager": e.target.numberOfEmployees.value > 13 ?  e.target.employee14IsManager.checked : null,

                    "employee15Name": e.target.numberOfEmployees.value > 14 ? e.target.employee15Name.value : null,
                    "employee15LoginName": e.target.numberOfEmployees.value > 14 ? e.target.employee15LoginName.value : null,
                    "employee15Email": e.target.numberOfEmployees.value > 14 ? e.target.employee15Email.value : null,
                    "employee15Department": e.target.numberOfEmployees.value > 14 ? e.target.employee15Department.value : null,
                    "employee15IsManager": e.target.numberOfEmployees.value > 14 ? e.target.employee15IsManager.checked : null,

                    "employee16Name": e.target.numberOfEmployees.value > 15 ?  e.target.employee16Name.value : null,
                    "employee16LoginName": e.target.numberOfEmployees.value > 15 ?  e.target.employee16LoginName.value : null,
                    "employee16Email": e.target.numberOfEmployees.value > 15 ?  e.target.employee16Email.value : null,
                    "employee16Department": e.target.numberOfEmployees.value > 15 ?  e.target.employee16Department.value : null,
                    "employee16IsManager": e.target.numberOfEmployees.value > 15 ?  e.target.employee16IsManager.checked : null,

                    "employee17Name": e.target.numberOfEmployees.value > 16 ?  e.target.employee17Name.value : null,
                    "employee17LoginName": e.target.numberOfEmployees.value > 16 ?  e.target.employee17LoginName.value : null,
                    "employee17Email": e.target.numberOfEmployees.value > 16 ?  e.target.employee17Email.value : null,
                    "employee17Department": e.target.numberOfEmployees.value > 16 ?  e.target.employee17Department.value : null,
                    "employee17IsManager": e.target.numberOfEmployees.value > 16 ?  e.target.employee17IsManager.checked : null,

                    "employee18Name": e.target.numberOfEmployees.value > 17 ? e.target.employee18Name.value : null,
                    "employee18LoginName": e.target.numberOfEmployees.value > 17 ? e.target.employee18LoginName.value : null,
                    "employee18Email": e.target.numberOfEmployees.value > 17 ? e.target.employee18Email.value : null,
                    "employee18Department": e.target.numberOfEmployees.value > 17 ? e.target.employee18Department.value : null,
                    "employee18IsManager": e.target.numberOfEmployees.value > 17 ? e.target.employee18IsManager.checked : null,

                    "employee19Name": e.target.numberOfEmployees.value > 18 ?  e.target.employee19Name.value : null,
                    "employee19LoginName": e.target.numberOfEmployees.value > 18 ?  e.target.employee19LoginName.value : null,
                    "employee19Email": e.target.numberOfEmployees.value > 18 ?  e.target.employee19Email.value : null,
                    "employee19Department": e.target.numberOfEmployees.value > 18 ?  e.target.employee19Department.value : null,
                    "employee19IsManager": e.target.numberOfEmployees.value > 18 ?  e.target.employee19IsManager.checked : null,

                    "employee20Name": e.target.numberOfEmployees.value > 19 ?  e.target.employee20Name.value : null,
                    "employee20LoginName": e.target.numberOfEmployees.value > 19 ?  e.target.employee20LoginName.value : null,
                    "employee20Email": e.target.numberOfEmployees.value > 19 ?  e.target.employee20Email.value : null,
                    "employee20Department": e.target.numberOfEmployees.value > 19 ?  e.target.employee20Department.value : null,
                    "employee20IsManager": e.target.numberOfEmployees.value > 19 ?  e.target.employee20IsManager.checked : null,

                    "employee21Name": e.target.numberOfEmployees.value > 20 ? e.target.employee21Name.value : null,
                    "employee21LoginName": e.target.numberOfEmployees.value > 20 ? e.target.employee21LoginName.value : null,
                    "employee21Email": e.target.numberOfEmployees.value > 20 ? e.target.employee21Email.value : null,
                    "employee21Department": e.target.numberOfEmployees.value > 20 ? e.target.employee21Department.value : null,
                    "employee21IsManager": e.target.numberOfEmployees.value > 20 ? e.target.employee21IsManager.checked : null,

                    "employee22Name": e.target.numberOfEmployees.value > 21 ?  e.target.employee22Name.value : null,
                    "employee22LoginName": e.target.numberOfEmployees.value > 21 ?  e.target.employee22LoginName.value : null,
                    "employee22Email": e.target.numberOfEmployees.value > 21 ?  e.target.employee22Email.value : null,
                    "employee22Department": e.target.numberOfEmployees.value > 21 ?  e.target.employee22Department.value : null,
                    "employee22IsManager": e.target.numberOfEmployees.value > 21 ?  e.target.employee22IsManager.checked : null,

                    "employee23Name": e.target.numberOfEmployees.value > 22 ?  e.target.employee23Name.value : null,
                    "employee23LoginName": e.target.numberOfEmployees.value > 22 ?  e.target.employee23LoginName.value : null,
                    "employee23Email": e.target.numberOfEmployees.value > 22 ?  e.target.employee23Email.value : null,
                    "employee23Department": e.target.numberOfEmployees.value > 22 ?  e.target.employee23Department.value : null,
                    "employee23IsManager": e.target.numberOfEmployees.value > 22 ?  e.target.employee23IsManager.checked : null,

                    "employee24Name": e.target.numberOfEmployees.value > 23 ? e.target.employee24Name.value : null,
                    "employee24LoginName": e.target.numberOfEmployees.value > 23 ? e.target.employee24LoginName.value : null,
                    "employee24Email": e.target.numberOfEmployees.value > 23 ? e.target.employee24Email.value : null,
                    "employee24Department": e.target.numberOfEmployees.value > 23 ? e.target.employee24Department.value : null,
                    "employee24IsManager": e.target.numberOfEmployees.value > 23 ? e.target.employee24IsManager.checked : null,

                    "employee25Name": e.target.numberOfEmployees.value > 24 ?  e.target.employee25Name.value : null,
                    "employee25LoginName": e.target.numberOfEmployees.value > 24 ?  e.target.employee25LoginName.value : null,
                    "employee25Email": e.target.numberOfEmployees.value > 24 ?  e.target.employee25Email.value : null,
                    "employee25Department": e.target.numberOfEmployees.value > 24 ?  e.target.employee25Department.value : null,
                    "employee25IsManager": e.target.numberOfEmployees.value > 24 ?  e.target.employee25IsManager.checked : null,

                }),
            })
            .catch(err => console.error("Download failed", err));
        });

        let fetchTicket = ()=>{
            // Display on the fetch button that it is fetching
            document.getElementById('fetchTicketButton').disabled = true
            document.getElementById('fetchTicketButton').innerHTML = "Running"
            document.getElementById('fetchTicketButton').style.backgroundColor = "orange"
            document.getElementById('fetchTicketButton').style.padding = "10px"

            const myHeaders = new Headers();
            myHeaders.append("Content-Type", "application/json");

            const raw = JSON.stringify({
            "Name": "",
            "Email": "",
            "TicketID": Number(document.getElementById('ticketNumberInput').value),
            "Task": "Return ticket details",
            "Note": "",
            "Env": document.getElementById('env-dropdown-button').innerHTML==="Preview"?"http://hseconnect.previewourapp.com/Login":"http://hseconnect.com/Login"
            });

            const requestOptions = {
            method: "POST",
            headers: myHeaders,
            body: raw,
            redirect: "follow"
            };

            fetch("https://prod-19.australiasoutheast.logic.azure.com:443/workflows/ece9c78292324b17bf0c8f68f010cb6b/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=WLYxCqqlzpQMLo4-YVwIdiApsi5FIqCZvMrFLNA4A4U", requestOptions)
            .then((response) => response.json())
            .then((result) => {
                
            console.log(result)
            // Populate ticket details on form 
            document.getElementById('companyName').value = result.CompanyName
            document.getElementById('isMTA').checked = result.CustomerType==="MTA"? true:false; 

            // Reset the fetch button
            document.getElementById('fetchTicketButton').disabled = false
            document.getElementById('fetchTicketButton').innerHTML = "Fetch Ticket"
            document.getElementById('fetchTicketButton').style.backgroundColor = null
            document.getElementById('fetchTicketButton').style.padding = null
            })
            .catch((error) => console.error(error));

        }

        let chooseEnv = (env)=>{
            document.getElementById('env-dropdown-button').innerHTML=env
            document.getElementById('dropdown').classList.add("hidden")
        }

    </script>
</body>

</html>
